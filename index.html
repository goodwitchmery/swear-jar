<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Swear Jar</title>
  <style>
    body {
      background-color: black;
      color: orange;
      font-family: 'Arial Black', sans-serif;
      text-align: center;
      height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      margin: 0;
    }

    #counter {
      font-size: 3em;
      text-shadow: 0 0 20px orange;
      opacity: 1;
      margin-bottom: 40px;
      transition: transform 0.3s;
    }

    .pop {
      transform: scale(1.3);
    }

    button {
      background-color: orange;
      color: black;
      font-weight: bold;
      border: none;
      border-radius: 10px;
      padding: 15px 30px;
      font-size: 1.2em;
      cursor: pointer;
      margin: 10px;
      transition: all 0.2s;
    }

    button:hover {
      background-color: gold;
      transform: scale(1.1);
    }

    #controls {
      display: flex;
      flex-direction: row;
      justify-content: center;
      gap: 15px;
    }
  </style>
</head>
<body>
  <div id="counter">Swear count: 0</div>

  <div id="controls">
    <button id="toggleBtn">ðŸŽ¤ Start Listening</button>
    <button id="resetBtn">ðŸ”„ Reset</button>
  </div>

  <script>
  document.addEventListener("DOMContentLoaded", () => {
    const counterEl = document.getElementById("counter");
    const toggleBtn = document.getElementById("toggleBtn");
    const resetBtn = document.getElementById("resetBtn");

    let count = parseInt(localStorage.getItem("swearCount")) || 0;
    let recognition;
    let isListening = false;

    counterEl.textContent = `Swear count: ${count}`;

    // English swear words
    const swears = [
      "fuck","fck","fak","fack","fuc","fucking","fucker","motherfucker","mf",
      "shit","shiet","shitty","bullshit","sheet","shyt","shiit",
      "bitch","bish","bich","bitsh","beech",
      "asshole","ass","azz","arse","ashole","azzhole",
      "bastard","crap","damn","dammit","dick","cock","pussy","slut","whore","cum",
      "boobs","tits","balls","hell","wanker","jerk","suck","hoe",
      "twat","prick","retard","dumbass","stupidass","fatass","cunt",
      "goddamn","holyshit","jackass","pieceofshit"
    ];

    function popCounter() {
      counterEl.classList.add("pop");
      setTimeout(() => counterEl.classList.remove("pop"), 400);
    }

    function updateCounter(newCount) {
      count = newCount;
      counterEl.textContent = `Swear count: ${count}`;
      localStorage.setItem("swearCount", count);
    }

    function detectSwears(text) {
      const cleaned = text.toLowerCase().replace(/[^\w* ]/g, " ");
      const words = cleaned.split(/\s+/).filter(Boolean);

      let swearsFound = 0;
      for (const word of words) {
        if (swears.some(s => word.includes(s)) || word.includes("***") || word.includes("****")) {
          swearsFound++;
        }
      }

      if (swearsFound > 0) {
        updateCounter(count + swearsFound);
        popCounter();
        console.log(`ðŸ’¥ Detected ${swearsFound} swears!`);
      }
    }

    function startRecognition() {
      const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
      if (!SpeechRecognition) {
        alert("Speech recognition not supported in this browser ðŸ˜¢");
        return;
      }

      recognition = new SpeechRecognition();
      recognition.lang = "en-US";
      recognition.continuous = true;
      recognition.interimResults = false;

      recognition.onresult = (event) => {
        const transcript = event.results[event.results.length - 1][0].transcript.trim();
        console.log("ðŸ—£ï¸ Heard:", transcript);
        detectSwears(transcript);
      };

      recognition.onerror = (err) => {
        console.warn("âš ï¸ Speech error:", err.error);
      };

      recognition.onend = () => {
        if (isListening) {
          console.log("ðŸ” Restarting recognition...");
          recognition.start();
        }
      };

      recognition.start();
      console.log("ðŸŽ§ Listening...");
    }

    toggleBtn.addEventListener("click", async () => {
      if (!isListening) {
        try {
          await navigator.mediaDevices.getUserMedia({ audio: true });
          startRecognition();
          isListening = true;
          toggleBtn.textContent = "â¸ï¸ Pause Listening";
        } catch (err) {
          console.error("âŒ Mic error:", err);
          alert("Microphone access failed ðŸ˜¢");
        }
      } else {
        isListening = false;
        recognition?.stop();
        toggleBtn.textContent = "ðŸŽ¤ Resume Listening";
        console.log("â¸ï¸ Listening paused");
      }
    });

    resetBtn.addEventListener("click", () => {
      updateCounter(0);
      console.log("ðŸ”„ Counter reset");
    });
  });
  </script>
</body>
</html>
